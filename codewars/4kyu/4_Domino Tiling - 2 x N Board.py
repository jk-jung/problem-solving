def two_by_n(n, k):
    d1 = [0, 0, 0]
    d2 = [1, 0, 0]
    for _ in range(n):
        d3 = [0, 0, 0]

        d3[1] = d2[0] * k + d2[1] * (k-1) + d2[2] * (k-2)
        d3[2] = d1[0] * k * (k-1)
        d3[2] += d1[1] * (k-1) * (k-2)
        d3[2] += d1[2] * (k-1)
        d3[2] += d1[2] * (k-2) * (k-2)

        d3 = [x % 12345787 for x in d3]
        d1 = d2
        d2 = d3

    return sum(d2) % 12345787